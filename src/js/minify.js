document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("hamburgerBtn"),t=document.getElementById("navOverlay"),a=document.getElementById("mobileNav"),l=document.getElementById("desktopNav"),s=document.querySelector(".nav-mobile-buttons"),i=document.getElementById("columnsContainer"),o=document.getElementById("mainTitle"),n=document.getElementById("subcategoriesContainer"),r=document.getElementById("mainMenuContainer");document.getElementById("menu-container");let c=document.getElementById("photoModal"),d=document.getElementById("modalImage"),p=document.getElementById("modalTitle"),m=document.getElementById("modalDesc"),y=document.getElementById("modalPrice"),u=document.getElementById("closeModal"),v=document.getElementById("cartaBtn"),f=document.getElementById("cartaContainer"),g=document.getElementById("pdfViewer"),h=document.getElementById("backFromCartaBtn");function E(){if(!e||!l||!s)return;let i=l.querySelectorAll(".filter-btn:not(.carta-btn)");function o(){e.classList.toggle("active"),t.classList.toggle("active"),a.classList.toggle("active"),document.body.classList.toggle("menu-open")}function n(){window.innerWidth>767&&(e.classList.remove("active"),t.classList.remove("active"),a.classList.remove("active"),document.body.classList.remove("menu-open"))}i.forEach(e=>{let t=e.cloneNode(!0);s.appendChild(t)}),e&&e.addEventListener("click",o),t&&t.addEventListener("click",o),window.addEventListener("resize",n),n()}E();let b=document.querySelectorAll(".filter-btn"),$={pizzas:{title:"Pizzas",description:"Hechas con masa casera e ingredientes frescos"},"menu-diario":{title:"Men\xfa Diario",description:"Platos del d\xeda elaborados con ingredientes frescos"},milanesas:{title:"Milanesas al Plato",description:"Crujientes por fuera, jugosas por dentro"},empanadas:{title:"Empanadas",description:"Hechas al horno con masa casera"},burgers:{title:"Hamburguesas",description:"Las mejores hamburguesas artesanales"},sandwiches:{title:"Sandwiches y Lomos",description:"En pan casero y con los mejores ingredientes"},"papas-fritas":{title:"Papas Fritas",description:"Para compartir o acompa\xf1ar"},ensaladas:{title:"Ensaladas",description:"Opciones frescas y saludables"},postres:{title:"Postres",description:"El toque dulce para el final"},"menu-infantil":{title:"Men\xfa Infantil",description:"Pensado para los m\xe1s peque\xf1os"},otros:{title:"Otros Platos y Adicionales",description:"Variedades especiales de la casa"}},L={},w=[];function B(){[{id:"col-left-1",class:"column-left-1"},{id:"col-left-2",class:"column-left-2"},{id:"col-left-3",class:"column-left-3"},{id:"col-right-1",class:"column-right-1"},{id:"col-right-2",class:"column-right-2"},{id:"col-right-3",class:"column-right-3"},].forEach(e=>{let t=document.createElement("div");t.className=`column-wrapper ${e.class}`,t.id=e.id,i.appendChild(t),I(e.id)}),setInterval(()=>{document.querySelectorAll(".spear-tip-top, .spear-tip-bottom").forEach(e=>{e.style.filter.includes("drop-shadow")||(e.style.filter="drop-shadow(0 0 15px rgba(255, 255, 255, 0.7)) drop-shadow(0 0 8px rgba(255, 255, 255, 0.5))")})},1e3),setTimeout(()=>{document.querySelectorAll(".column-wrapper").forEach((e,t)=>{e.style.animationDelay=`${.5*t}s`})},100)}function I(e){let t=document.getElementById(e);t.innerHTML=`
      <div class="column-container">
        <div class="light-beam-top"></div>
        <div class="light-beam-bottom"></div>
        <div class="center-glow"></div>
        <div class="spear-tip-top"></div>
        <div class="spear-tip-bottom"></div>
        <div class="column"></div>
        <div class="petal petal-1"></div>
        <div class="petal petal-2"></div>
        <div class="petal petal-3"></div>
        <div class="petal petal-4"></div>
        <div class="petal-small petal-small-1"></div>
        <div class="petal-small petal-small-2"></div>
        <div class="petal-small petal-small-3"></div>
        <div class="petal-small petal-small-4"></div>
      </div>
    `}function k(){let e=window.innerWidth<768;document.querySelectorAll(".column-wrapper").forEach(t=>{let a=t.id;e&&(a.includes("-2")||a.includes("-3"))?t.style.display="none":t.style.display="block"}),j()}async function S(){try{let e=await fetch("productos.json");if(!e.ok)throw Error("Error al cargar JSON");let t=await e.json();w=t.productos;let a={Pizzas:"pizzas","Men\xfa Diario":"menu-diario","Milanesas al plato":"milanesas",Empanadas:"empanadas",Hamburguesas:"burgers",Sandwiches:"sandwiches","Papas Fritas":"papas-fritas",Ensaladas:"ensaladas",Postres:"postres","Men\xfa Infantil":"menu-infantil","Otros Platos":"otros",Adicionales:"otros"};Object.keys($).forEach(e=>{L[e]=[]}),L.otros=[],L.all=[...w],t.productos.forEach(e=>{let t=a[e.categoria]||"otros";L[t]||(L[t]=[]),L[t].push(e)}),_()}catch(l){console.error("Error cargando productos:",l),C()}}function C(){w=[{id:"ejemplo1",nombre:"Pizza Margarita",precio:14e3,categoria:"Pizzas",descripcion:"Salsa, muzzarella y parmesano",image:""},{id:"ejemplo2",nombre:"Hamburguesa Cl\xe1sica",precio:16e3,categoria:"Hamburguesas",descripcion:"Doble medall\xf3n con queso",image:""}],Object.keys($).forEach(e=>{L[e]=[]}),L.all=[...w],L.pizzas=[w[0]],L.burgers=[w[1]],_()}function _(){r.innerHTML="",r.style.display="block",n.style.display="none",Object.keys($).forEach(e=>{let t=L[e];if(t&&t.length>0){let a=document.createElement("div");a.className="category-group-header",a.style.width="100%",a.style.margin="30px 0 15px 0",a.style.borderBottom="2px solid var(--neon-blue, #0ff)";let l=document.createElement("h2");l.textContent=$[e].title,l.style.color="var(--neon-main, #fff)",l.style.fontFamily="'Orbitron', sans-serif",l.style.fontSize="1.8rem",l.style.marginBottom="10px",l.style.textShadow="0 0 10px rgba(0, 255, 255, 0.5)",a.appendChild(l),r.appendChild(a);let s=document.createElement("div");s.className="category-group-items";let i="";t.forEach(e=>{i+=z(e)}),s.innerHTML=i,r.appendChild(s)}}),""===r.innerHTML&&(r.innerHTML='<div class="no-products">No hay productos disponibles</div>'),A(r)}function q(){f&&"block"===f.style.display&&N(),_(),n.style.display="none",n.innerHTML="",r&&(r.style.display="block");let e=document.getElementById("menu-title");e&&(e.textContent="TODOS LOS PRODUCTOS"),document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="1"})}function x(e){f&&"block"===f.style.display&&N();let t=L[e]||[];M(t);let a=document.getElementById("menu-title");if(a){let l=e.toUpperCase().replace(/-/g," ").replace("MENU","MEN\xda");a.textContent=l}document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="1"})}function M(e){let t=r||document.getElementById("menu-container");if(!t)return;if(t.style.display="block",0===e.length){t.innerHTML='<div class="no-products">No hay productos en esta categor\xeda</div>';return}let a="";e.forEach(e=>{a+=z(e)}),t.innerHTML=a,A(t)}function z(e){return`
        <div class="menu-item fade-in">
          <div class="item-info">
            <div class="item-name">${e.nombre}</div>
            <div class="item-desc">${e.descripcion||""}</div>
          </div>
          <div class="item-price-container">
            <div class="item-price">$${e.precio}</div>
            <button class="view-photo-btn" 
              data-img="${e.image||""}" 
              data-title="${e.nombre}" 
              data-desc="${e.descripcion||""}" 
              data-price="$${e.precio}">
              Click aqu\xed
            </button>
          </div>
        </div>
      `}function A(e){e.querySelectorAll(".view-photo-btn").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();let{img:a,title:l,desc:s,price:i}=e.dataset;H(a,l,s,i),P()})}),e.querySelectorAll(".menu-item").forEach(e=>{e.addEventListener("click",function(){this.style.backgroundColor="#2a2a2a",this.style.borderColor="var(--neon-main)",setTimeout(()=>{this.style.backgroundColor="var(--card-bg)",this.style.borderColor="transparent"},200),o.style.textShadow="0 0 10px #ff00ff, 0 0 40px #ff00ff",setTimeout(()=>o.style.textShadow="",300),P()})})}function P(){document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="0.7",e.style.transform="scale(1.05)",setTimeout(()=>{e.style.opacity="0.5",e.style.transform="scale(1)"},500)})}function H(e,t,a,l){d.src=e&&""!==e.trim()?e:"https://images.unsplash.com/photo-1555396273-367ea4eb4db5?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",d.alt=`Foto de ${t}`,p.textContent=t,m.textContent=a,y.textContent=l,c.classList.add("active"),document.body.style.overflow="hidden"}function O(){c.classList.remove("active"),document.body.style.overflow="auto"}function T(){r&&(r.style.display="none"),n.style.display="none",f.style.display="block",b.forEach(e=>{e.classList.remove("active"),e===v&&e.classList.add("active")}),document.body.classList.add("carta-active"),g.src="./src/Carta.pdf",document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="0.2",e.style.filter="blur(2px)"}),f.scrollIntoView({behavior:"smooth"}),j()}function N(){r&&(r.style.display="block"),n.style.display="none",f.style.display="none",b.forEach(e=>e.classList.remove("active")),b[0]&&b[0].classList.add("active"),document.body.classList.remove("carta-active"),document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="0.5",e.style.filter="none"}),document.querySelector(".category-nav").scrollIntoView({behavior:"smooth"})}function j(){let e=window.innerWidth<768,t=document.getElementById("pdfViewer");e&&t?t.style.height="400px":t&&(t.style.height="600px")}B(),window.addEventListener("resize",k),S(),b.forEach(l=>{l.addEventListener("click",s=>{if(s.stopPropagation(),a&&a.classList.contains("active")&&(e.classList.remove("active"),t.classList.remove("active"),a.classList.remove("active"),document.body.classList.remove("menu-open")),l===v){T();return}let i=l.getAttribute("data-category"),o=document.querySelectorAll(".filter-btn");o.forEach(e=>e.classList.remove("active"));let n=document.querySelectorAll(`.filter-btn[data-category="${i}"]`);n.forEach(e=>e.classList.add("active")),"all"===i?q():x(i),document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="0.3",setTimeout(()=>e.style.opacity="0.5",300)})})}),u.addEventListener("click",O),c.addEventListener("click",e=>{e.target===c&&O()}),h.addEventListener("click",N),document.addEventListener("keydown",e=>{"Escape"===e.key&&(c.classList.contains("active")?O():"block"===f.style.display&&N())}),j()});
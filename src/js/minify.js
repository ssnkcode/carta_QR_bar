document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("hamburgerBtn"),t=document.getElementById("navOverlay"),a=document.getElementById("mobileNav"),l=document.getElementById("desktopNav"),s=document.querySelector(".nav-mobile-buttons"),i=document.getElementById("columnsContainer"),o=document.getElementById("mainTitle"),r=document.getElementById("subcategoriesContainer"),n=document.getElementById("mainMenuContainer");document.getElementById("menu-container");let c=document.getElementById("photoModal"),d=document.getElementById("modalImage"),p=document.getElementById("modalTitle"),m=document.getElementById("modalDesc"),y=document.getElementById("modalPrice"),u=document.getElementById("closeModal");document.getElementById("cartaBtn");let v=document.getElementById("cartaContainer"),f=document.getElementById("pdfViewer"),g=document.getElementById("backFromCartaBtn");function h(){if(!e||!l||!s)return;let i=l.querySelectorAll(".filter-btn");function o(){e.classList.toggle("active"),t.classList.toggle("active"),a.classList.toggle("active"),document.body.classList.toggle("menu-open")}function r(){window.innerWidth>767&&(e.classList.remove("active"),t.classList.remove("active"),a.classList.remove("active"),document.body.classList.remove("menu-open"))}i.forEach(e=>{let t=e.cloneNode(!0);t.removeAttribute("id"),s.appendChild(t)}),e&&e.addEventListener("click",o),t&&t.addEventListener("click",o),window.addEventListener("resize",r),r()}h();let E=document.querySelectorAll(".filter-btn"),b={pizzas:{title:"Pizzas",description:"Hechas con masa casera e ingredientes frescos"},"menu-diario":{title:"Men\xfa Diario",description:"Platos del d\xeda elaborados con ingredientes frescos"},milanesas:{title:"Milanesas al Plato",description:"Crujientes por fuera, jugosas por dentro"},empanadas:{title:"Empanadas",description:"Hechas al horno con masa casera"},burgers:{title:"Hamburguesas",description:"Las mejores hamburguesas artesanales"},sandwiches:{title:"Sandwiches y Lomos",description:"En pan casero y con los mejores ingredientes"},"papas-fritas":{title:"Papas Fritas",description:"Para compartir o acompa\xf1ar"},ensaladas:{title:"Ensaladas",description:"Opciones frescas y saludables"},postres:{title:"Postres",description:"El toque dulce para el final"},"menu-infantil":{title:"Men\xfa Infantil",description:"Pensado para los m\xe1s peque\xf1os"},otros:{title:"Otros Platos y Adicionales",description:"Variedades especiales de la casa"}},$={},L=[];function w(){[{id:"col-left-1",class:"column-left-1"},{id:"col-left-2",class:"column-left-2"},{id:"col-left-3",class:"column-left-3"},{id:"col-right-1",class:"column-right-1"},{id:"col-right-2",class:"column-right-2"},{id:"col-right-3",class:"column-right-3"},].forEach(e=>{let t=document.createElement("div");t.className=`column-wrapper ${e.class}`,t.id=e.id,i.appendChild(t),B(e.id)}),setInterval(()=>{document.querySelectorAll(".spear-tip-top, .spear-tip-bottom").forEach(e=>{e.style.filter.includes("drop-shadow")||(e.style.filter="drop-shadow(0 0 15px rgba(255, 255, 255, 0.7)) drop-shadow(0 0 8px rgba(255, 255, 255, 0.5))")})},1e3),setTimeout(()=>{document.querySelectorAll(".column-wrapper").forEach((e,t)=>{e.style.animationDelay=`${.5*t}s`})},100)}function B(e){let t=document.getElementById(e);t.innerHTML=`
      <div class="column-container">
        <div class="light-beam-top"></div>
        <div class="light-beam-bottom"></div>
        <div class="center-glow"></div>
        <div class="spear-tip-top"></div>
        <div class="spear-tip-bottom"></div>
        <div class="column"></div>
        <div class="petal petal-1"></div>
        <div class="petal petal-2"></div>
        <div class="petal petal-3"></div>
        <div class="petal petal-4"></div>
        <div class="petal-small petal-small-1"></div>
        <div class="petal-small petal-small-2"></div>
        <div class="petal-small petal-small-3"></div>
        <div class="petal-small petal-small-4"></div>
      </div>
    `}function k(){let e=window.innerWidth<768;document.querySelectorAll(".column-wrapper").forEach(t=>{let a=t.id;e&&(a.includes("-2")||a.includes("-3"))?t.style.display="none":t.style.display="block"}),N()}async function C(){try{let e=await fetch("productos.json");if(!e.ok)throw Error("Error al cargar JSON");let t=await e.json();L=t.productos;let a={Pizzas:"pizzas","Men\xfa Diario":"menu-diario","Milanesas al plato":"milanesas",Empanadas:"empanadas",Hamburguesas:"burgers",Sandwiches:"sandwiches","Papas Fritas":"papas-fritas",Ensaladas:"ensaladas",Postres:"postres","Men\xfa Infantil":"menu-infantil","Otros Platos":"otros",Adicionales:"otros"};Object.keys(b).forEach(e=>{$[e]=[]}),$.otros=[],$.all=[...L],t.productos.forEach(e=>{let t=a[e.categoria]||"otros";$[t]||($[t]=[]),$[t].push(e)}),S()}catch(l){console.error("Error cargando productos:",l),I()}}function I(){L=[{id:"ejemplo1",nombre:"Pizza Margarita",precio:14e3,categoria:"Pizzas",descripcion:"Salsa, muzzarella y parmesano",image:""},{id:"ejemplo2",nombre:"Hamburguesa Cl\xe1sica",precio:16e3,categoria:"Hamburguesas",descripcion:"Doble medall\xf3n con queso",image:""}],Object.keys(b).forEach(e=>{$[e]=[]}),$.all=[...L],$.pizzas=[L[0]],$.burgers=[L[1]],S()}function S(){n.innerHTML="",n.style.display="block",r.style.display="none",Object.keys(b).forEach(e=>{let t=$[e];if(t&&t.length>0){let a=document.createElement("div");a.className="category-group-header",a.style.width="100%",a.style.margin="30px 0 15px 0",a.style.borderBottom="2px solid var(--neon-blue, #0ff)";let l=document.createElement("h2");l.textContent=b[e].title,l.style.color="var(--neon-main, #fff)",l.style.fontFamily="'Orbitron', sans-serif",l.style.fontSize="1.8rem",l.style.marginBottom="10px",l.style.textShadow="0 0 10px rgba(0, 255, 255, 0.5)",a.appendChild(l),n.appendChild(a);let s=document.createElement("div");s.className="category-group-items";let i="";t.forEach(e=>{i+=M(e)}),s.innerHTML=i,n.appendChild(s)}}),""===n.innerHTML&&(n.innerHTML='<div class="no-products">No hay productos disponibles</div>'),z(n)}function _(){v&&"block"===v.style.display&&O(),S(),r.style.display="none",r.innerHTML="",n&&(n.style.display="block");let e=document.getElementById("menu-title");e&&(e.textContent="TODOS LOS PRODUCTOS"),document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="1"})}function q(e){v&&"block"===v.style.display&&O();let t=$[e]||[];x(t);let a=document.getElementById("menu-title");if(a){let l=e.toUpperCase().replace(/-/g," ").replace("MENU","MEN\xda");a.textContent=l}document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="1"})}function x(e){let t=n||document.getElementById("menu-container");if(!t)return;if(t.style.display="block",0===e.length){t.innerHTML='<div class="no-products">No hay productos en esta categor\xeda</div>';return}let a="";e.forEach(e=>{a+=M(e)}),t.innerHTML=a,z(t)}function M(e){let t=e.nombre?e.nombre.trim():"",a=e.descripcion?e.descripcion.trim():"";return`
        <div class="menu-item fade-in">
          <div class="item-info">
            <div class="item-name">${t}</div>
            <div class="item-desc">${a}</div>
          </div>
          <div class="item-price-container">
            <div class="item-price">$${e.precio}</div>
            <button class="view-photo-btn" 
              data-img="${e.image||""}" 
              data-title="${t}" 
              data-desc="${a}" 
              data-price="$${e.precio}">
              Click aqu\xed
            </button>
          </div>
        </div>
      `}function z(e){e.querySelectorAll(".view-photo-btn").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();let{img:a,title:l,desc:s,price:i}=e.dataset;P(a,l,s,i),A()})}),e.querySelectorAll(".menu-item").forEach(e=>{e.addEventListener("click",function(){this.style.backgroundColor="#2a2a2a",this.style.borderColor="var(--neon-main)",setTimeout(()=>{this.style.backgroundColor="var(--card-bg)",this.style.borderColor="transparent"},200),o.style.textShadow="0 0 10px #ff00ff, 0 0 40px #ff00ff",setTimeout(()=>o.style.textShadow="",300),A()})})}function A(){document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="0.7",e.style.transform="scale(1.05)",setTimeout(()=>{e.style.opacity="0.5",e.style.transform="scale(1)"},500)})}function P(e,t,a,l){d.src=e&&""!==e.trim()?e:"https://images.unsplash.com/photo-1555396273-367ea4eb4db5?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",d.alt=`Foto de ${t}`,p.textContent=t,m.textContent=a,y.textContent=l,c.classList.add("active"),document.body.style.overflow="hidden"}function T(){c.classList.remove("active"),document.body.style.overflow="auto"}function H(){n&&(n.style.display="none"),r.style.display="none",v.style.display="block",E.forEach(e=>{e.classList.remove("active"),"carta"===e.dataset.category&&e.classList.add("active")}),document.body.classList.add("carta-active"),f.src="./src/Carta.pdf",document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="0.2",e.style.filter="blur(2px)"}),window.scrollTo({top:0,behavior:"smooth"}),N()}function O(){n&&(n.style.display="block"),r.style.display="none",v.style.display="none",E.forEach(e=>e.classList.remove("active")),E[0]&&E[0].classList.add("active"),document.body.classList.remove("carta-active"),document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="0.5",e.style.filter="none"}),window.scrollTo({top:0,behavior:"smooth"})}function N(){let e=window.innerWidth<768,t=document.getElementById("pdfViewer");e&&t?t.style.height="75vh":t&&(t.style.height="600px")}w(),window.addEventListener("resize",k),C(),E.forEach(l=>{l.addEventListener("click",s=>{s.stopPropagation(),a&&a.classList.contains("active")&&(e.classList.remove("active"),t.classList.remove("active"),a.classList.remove("active"),document.body.classList.remove("menu-open"));let i=l.getAttribute("data-category");if("carta"===i){H();return}window.scrollTo({top:0,behavior:"smooth"});let o=document.querySelectorAll(".filter-btn");o.forEach(e=>e.classList.remove("active"));let r=document.querySelectorAll(`.filter-btn[data-category="${i}"]`);r.forEach(e=>e.classList.add("active")),"all"===i?_():q(i),document.querySelectorAll(".column-wrapper").forEach(e=>{e.style.opacity="0.3",setTimeout(()=>e.style.opacity="0.5",300)})})}),u.addEventListener("click",T),c.addEventListener("click",e=>{e.target===c&&T()}),g.addEventListener("click",O),document.addEventListener("keydown",e=>{"Escape"===e.key&&(c.classList.contains("active")?T():"block"===v.style.display&&O())}),N()});